============================= test session starts =============================
platform win32 -- Python 3.12.7, pytest-9.0.2, pluggy-1.6.0 -- C:\Users\Kurian Jose\Desktop\kurian stuff\hackfest2.0\Noise filter module\venv\Scripts\python.exe
cachedir: .pytest_cache
rootdir: C:\Users\Kurian Jose\Desktop\kurian stuff\hackfest2.0
collecting ... collected 10 items

Noise filter module/tests/test_classifier.py::test_classify_simple_sample FAILED [ 10%]
Noise filter module/tests/test_enron_parser.py::test_strip_boilerplate_removes_forwarded_header FAILED [ 20%]
Noise filter module/tests/test_enron_parser.py::test_strip_boilerplate_removes_disclaimer PASSED [ 30%]
Noise filter module/tests/test_enron_parser.py::test_flatten_thread_splits_replies PASSED [ 40%]
Noise filter module/tests/test_enron_parser.py::test_deduplicate_removes_duplicates PASSED [ 50%]
Noise filter module/tests/test_heuristics.py::test_short_text_is_noise PASSED [ 60%]
Noise filter module/tests/test_heuristics.py::test_social_noise PASSED   [ 70%]
Noise filter module/tests/test_heuristics.py::test_system_mail_is_noise PASSED [ 80%]
Noise filter module/tests/test_heuristics.py::test_calendar_invite_is_timeline PASSED [ 90%]
Noise filter module/tests/test_heuristics.py::test_normal_text_returns_none FAILED [100%]

================================== FAILURES ===================================
_________________________ test_classify_simple_sample _________________________

    def test_classify_simple_sample():
        api_key = os.getenv("GEMINI_API_KEY")
        if not api_key:
            pytest.skip("GEMINI_API_KEY not found in .env, skipping integration test")
    
        chunks = [
            {
                "cleaned_text": "We must allow users to reset their password via email.",
                "speaker": "Alice",
                "source_ref": "<test1>"
            },
            {
                "cleaned_text": "Let's grab lunch at 12.",
                "speaker": "Bob",
                "source_ref": "<test2>"
            },
            {
                "cleaned_text": "The deadline for phase 1 is October 15th.",
                "speaker": "Charlie",
                "source_ref": "<test3>"
            }
        ]
    
        results = classify_chunks(chunks, api_key=api_key)
    
        assert len(results) == 3
    
        # Check item 1 (Requirement)
>       assert results[0].label.value == "requirement"
E       AssertionError: assert 'noise' == 'requirement'
E         
E         - requirement
E         + noise

Noise filter module\tests\test_classifier.py:42: AssertionError
_______________ test_strip_boilerplate_removes_forwarded_header _______________

    def test_strip_boilerplate_removes_forwarded_header():
        text = """
        Hey,
    
        This is relevant.
    
        -----Original Message-----
        From: Bob
        Sent: Tuesday
        Subject: Old stuff
    
        Old body content.
        """
        cleaned = strip_boilerplate(text)
        assert "This is relevant." in cleaned
        assert "-----Original Message-----" not in cleaned
>       assert "Old body content" not in cleaned
E       AssertionError: assert 'Old body content' not in 'Hey,\n    \...ody content.'
E         
E         'Old body content' is contained here:
E           Hey,
E               
E               This is relevant.
E           
E               
E           
E               Old body content.

Noise filter module\tests\test_enron_parser.py:24: AssertionError
________________________ test_normal_text_returns_none ________________________

    def test_normal_text_returns_none():
        chunk = {"cleaned_text": "We need to finalize the API spec by Friday.", "speaker": "Alice"}
        # This is long enough and not pure noise, so it should pass through to LLM (return None)
>       assert apply_heuristics(chunk) is None
E       AssertionError: assert 'timeline_reference' is None
E        +  where 'timeline_reference' = apply_heuristics({'cleaned_text': 'We need to finalize the API spec by Friday.', 'speaker': 'Alice'})

Noise filter module\tests\test_heuristics.py:29: AssertionError
============================== warnings summary ===============================
Noise filter module\classifier.py:14
  C:\Users\Kurian Jose\Desktop\kurian stuff\hackfest2.0\Noise filter module\classifier.py:14: FutureWarning: 
  
  All support for the `google.generativeai` package has ended. It will no longer be receiving 
  updates or bug fixes. Please switch to the `google.genai` package as soon as possible.
  See README for more details:
  
  https://github.com/google-gemini/deprecated-generative-ai-python/blob/main/README.md
  
    import google.generativeai as genai

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ===========================
FAILED Noise filter module/tests/test_classifier.py::test_classify_simple_sample
FAILED Noise filter module/tests/test_enron_parser.py::test_strip_boilerplate_removes_forwarded_header
FAILED Noise filter module/tests/test_heuristics.py::test_normal_text_returns_none
=================== 3 failed, 7 passed, 1 warning in 7.00s ====================
